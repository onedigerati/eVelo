---
phase: 33-bulk-historical-data-management
plan: 04
type: execute
wave: 4
depends_on: ["33-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All 10 success criteria verified by human testing"
    - "Bulk import/export works end-to-end"
    - "Reset to defaults functionality works for all and individual"
---

<objective>
Human verification of complete bulk historical data management feature.

Purpose: Verify all 10 success criteria from the phase roadmap through hands-on testing of the complete bulk operations workflow.

Output: Verified feature or documented issues for gap closure.
</objective>

<execution_context>
@C:\Users\ungac\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\ungac\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/33-bulk-historical-data-management/33-01-PLAN.md
@.planning/phases/33-bulk-historical-data-management/33-02-PLAN.md
@.planning/phases/33-bulk-historical-data-management/33-03-PLAN.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete bulk historical data management feature including bulk export/import, preview-before-commit, reset-to-defaults, and format templates</what-built>
  <how-to-verify>
1. **Bulk Export (Success Criteria 1, 4):**
   - Open app at http://localhost:5173
   - Go to Settings -> Historical Data -> Manage Historical Data
   - Switch to "Bulk Operations" mode
   - Click "Export All as CSV" - verify file downloads with all assets
   - Click "Export All as JSON" - verify file downloads with version, exportedAt, assets array
   - Open downloaded files and verify asset_class is included for each asset

2. **Format Templates (Success Criteria 3):**
   - Click "Download CSV Template" - verify template.csv downloads
   - Click "Download JSON Template" - verify template.json downloads
   - Open templates - verify they contain example data with 5 years per asset
   - Verify format documentation is visible/explained

3. **Bulk Import with Preview (Success Criteria 2, 5, 8, 9):**
   - Edit the downloaded CSV template: modify some returns, add a new CUSTOM1 asset
   - Drag the file into the import drop zone
   - Verify preview table shows:
     - Existing assets as "UPDATE"
     - New assets as "ADD"
     - Invalid assets as "SKIP" with error messages
   - Verify validation feedback shows per-asset success/failure
   - Click "Import Valid Assets"
   - Verify success notification with count
   - Close and reopen viewer - verify imported data persists

4. **Reset All to Defaults (Success Criteria 6):**
   - With custom data imported, go to Bulk Operations
   - Find "Reset All to Defaults" section
   - Click the reset button
   - Verify two-step confirmation appears:
     - Checkbox required
     - Confirm button disabled until checkbox checked
   - Check the checkbox, click confirm
   - Verify all custom data is cleared
   - Verify viewer now shows bundled defaults

5. **Individual Asset Reset (Success Criteria 7):**
   - Import custom data for a single asset (switch to single asset mode)
   - View that asset - verify it shows "Using Custom Data" badge
   - Click "Reset to Defaults" for that asset
   - Verify it returns to bundled data

6. **Adding New Assets (Success Criteria 8):**
   - Create a CSV with a completely new symbol (e.g., NEWTEST)
   - Import via bulk import
   - Verify preview shows "ADD" action
   - Confirm import
   - Verify new asset appears in the system

7. **UI Flow (Success Criteria 10):**
   - Verify the flow is intuitive:
     - View format -> Download template
     - Edit file externally
     - Import -> Preview changes
     - Review per-asset status
     - Confirm or cancel
   - Verify mode toggle between Single Asset and Bulk Operations works

Expected behavior:
- All exports should complete and download valid files
- Preview table should accurately show what will change
- Only valid assets should be imported on confirm
- Reset requires explicit checkbox confirmation
- All data changes persist in IndexedDB across refreshes
  </how-to-verify>
  <resume-signal>Type "approved" if all 10 criteria pass, or describe specific issues found</resume-signal>
</task>

</tasks>

<verification>
All 10 success criteria from Phase 33 roadmap verified:
1. User can bulk export ALL assets in a single file (CSV or JSON) with asset class metadata
2. User can bulk import a file to update/add multiple assets at once
3. Clear format documentation shown before import (template/example provided)
4. Asset class information included in bulk format
5. Validation feedback shows per-asset success/failure with specific error messages
6. User can reset ALL custom data to bundled defaults with confirmation
7. User can reset individual assets to bundled defaults
8. Bulk import supports adding new assets (not just updating existing)
9. Preview mode shows what will change before committing bulk import
10. Intuitive UI flow: view format -> prepare file -> import -> review -> confirm
</verification>

<success_criteria>
Human verification confirms all 10 success criteria are met.
Feature is ready for production use.
</success_criteria>

<output>
After completion, create `.planning/phases/33-bulk-historical-data-management/33-04-SUMMARY.md`
</output>
