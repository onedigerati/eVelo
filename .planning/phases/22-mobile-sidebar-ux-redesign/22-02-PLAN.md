---
phase: 22-mobile-sidebar-ux-redesign
plan: 02
type: execute
wave: 2
depends_on: ["22-01"]
files_modified:
  - src/components/ui/sidebar-panel.ts
  - src/components/ui/main-layout.ts
autonomous: true

must_haves:
  truths:
    - "Mobile: 'eVelo Parameters' text label replaces hamburger icon"
    - "Desktop: 'eVelo Parameters' label rotates 90 degrees when sidebar is collapsed"
    - "Accessible with keyboard navigation and ARIA attributes"
    - "Dark theme styling maintained for collapsed/expanded states"
  artifacts:
    - path: "src/components/ui/sidebar-panel.ts"
      provides: "Branded toggle button with 'eVelo Parameters' label and rotated collapsed state"
      contains: "eVelo Parameters"
    - path: "src/components/ui/main-layout.ts"
      provides: "Mobile menu button with branded text instead of hamburger"
      contains: "eVelo Parameters"
  key_links:
    - from: "src/components/ui/sidebar-panel.ts"
      to: "src/components/ui/main-layout.ts"
      via: "toggle CustomEvent bubbling for collapse state"
      pattern: "toggle.*bubbles.*composed"
---

<objective>
Replace hamburger icon with branded "eVelo Parameters" text label and implement 90-degree rotation on desktop collapse.

Purpose: Improve navigation clarity by replacing generic hamburger icon with branded text label. Add visual interest with rotated label in desktop collapsed state.

Output: Updated sidebar-panel.ts with branded toggle button and rotated label CSS; updated main-layout.ts mobile menu button with branded text.
</objective>

<execution_context>
@C:\Users\ungac\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\ungac\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-mobile-sidebar-ux-redesign/22-RESEARCH.md
@.planning/phases/22-mobile-sidebar-ux-redesign/22-01-SUMMARY.md
@src/components/ui/sidebar-panel.ts
@src/components/ui/main-layout.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update sidebar-panel.ts with branded label and desktop rotation</name>
  <files>src/components/ui/sidebar-panel.ts</files>
  <action>
Update the sidebar-panel template and styles to use branded "eVelo Parameters" label with rotation on desktop collapse:

1. Update template() to use text label instead of icon:
   ```typescript
   protected template(): string {
     const isCollapsed = this.hasAttribute('collapsed');
     return `
       <aside class="sidebar">
         <button class="toggle-btn"
                 aria-label="${isCollapsed ? 'Expand' : 'Collapse'} parameters sidebar"
                 aria-expanded="${!isCollapsed}">
           <span class="toggle-label">eVelo Parameters</span>
           <span class="toggle-icon" aria-hidden="true">${isCollapsed ? '\u25B8' : '\u25C2'}</span>
         </button>
         <div class="sidebar-content">
           <slot></slot>
         </div>
         <div class="sidebar-footer">
           <slot name="footer"></slot>
         </div>
       </aside>
     `;
   }
   ```

   Note: Using Unicode triangles: \u25B8 (▸ right-pointing) and \u25C2 (◂ left-pointing).

2. Update attributeChangedCallback() to update the aria-label and icon:
   ```typescript
   override attributeChangedCallback(
     name: string,
     oldValue: string | null,
     newValue: string | null
   ): void {
     if (oldValue === newValue) return;

     if (name === 'collapsed') {
       const isCollapsed = newValue !== null;
       const icon = this.$('.toggle-icon');
       const toggleBtn = this.$('.toggle-btn');
       if (icon) {
         icon.textContent = isCollapsed ? '\u25B8' : '\u25C2';
       }
       if (toggleBtn) {
         toggleBtn.setAttribute('aria-expanded', String(!isCollapsed));
         toggleBtn.setAttribute('aria-label', `${isCollapsed ? 'Expand' : 'Collapse'} parameters sidebar`);
       }
     }
   }
   ```

3. Update styles() with branded label and rotation CSS:
   ```css
   .toggle-btn {
     display: flex;
     align-items: center;
     justify-content: space-between;
     gap: var(--spacing-sm, 8px);
     width: 100%;
     padding: var(--spacing-md, 16px);
     background: var(--color-primary, #0d9488);
     border: none;
     border-bottom: 1px solid var(--border-color, #e2e8f0);
     cursor: pointer;
     font-size: 1rem;
     color: var(--text-inverse, #ffffff);
     transition: background 0.2s ease;
   }

   .toggle-btn:hover {
     background: var(--color-primary-dark, #0f766e);
   }

   .toggle-btn:focus-visible {
     outline: 2px solid var(--text-inverse, #ffffff);
     outline-offset: -2px;
   }

   .toggle-label {
     font-weight: 600;
     font-size: var(--font-size-sm, 0.875rem);
     white-space: nowrap;
     transition: writing-mode 0.3s ease, opacity 0.3s ease;
   }

   .toggle-icon {
     font-size: 0.875rem;
     transition: transform 0.3s ease;
     flex-shrink: 0;
   }

   /* Desktop collapsed: vertical text using writing-mode */
   :host([collapsed]) .toggle-btn {
     justify-content: center;
     padding: var(--spacing-lg, 24px) var(--spacing-sm, 8px);
     height: 100%;
     flex-direction: column;
   }

   :host([collapsed]) .toggle-label {
     writing-mode: vertical-rl;
     text-orientation: mixed;
   }

   :host([collapsed]) .toggle-icon {
     transform: rotate(90deg);
     margin-top: var(--spacing-sm, 8px);
   }
   ```

4. Add dark theme styles:
   ```css
   /* Dark theme support */
   :host-context([data-theme="dark"]) .toggle-btn {
     background: var(--color-primary, #0d9488);
   }

   :host-context([data-theme="dark"]) .toggle-btn:hover {
     background: var(--color-primary-light, #14b8a6);
   }
   ```

5. Add mobile-specific overrides to keep label horizontal:
   ```css
   /* Mobile: Always horizontal label, hide icon */
   @media (max-width: 768px) {
     .toggle-btn {
       display: none; /* Hide on mobile - main-layout handles mobile toggle */
     }
   }
   ```
  </action>
  <verify>
Run `npm run build` to verify TypeScript compiles. Open dev server at desktop viewport - sidebar toggle should show "eVelo Parameters" text with teal background. Collapse sidebar - label should rotate 90 degrees using writing-mode: vertical-rl.
  </verify>
  <done>
Desktop sidebar shows branded "eVelo Parameters" toggle button with teal background. When collapsed, label rotates 90 degrees for vertical display. ARIA attributes update correctly for accessibility.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update main-layout.ts mobile menu button with branded text</name>
  <files>src/components/ui/main-layout.ts</files>
  <action>
Update the mobile menu button to display "eVelo Parameters" text instead of hamburger icon:

1. Update template() to use text label:
   ```html
   <button class="mobile-menu-btn" aria-label="Toggle parameters sidebar">
     <span class="menu-label">eVelo Parameters</span>
     <span class="menu-icon" aria-hidden="true">&#9662;</span>
   </button>
   ```

   Note: Using &#9662; (▾) down-pointing triangle when expanded, will flip to &#9652; (▴) when collapsed.

2. Update styles() for mobile menu button:
   ```css
   .mobile-menu-btn {
     display: none;
     align-items: center;
     justify-content: center;
     gap: var(--spacing-xs, 4px);
     background: var(--color-primary, #0d9488);
     border: none;
     font-size: var(--font-size-sm, 0.875rem);
     font-weight: 600;
     cursor: pointer;
     padding: var(--spacing-sm, 8px) var(--spacing-md, 16px);
     color: var(--text-inverse, #ffffff);
     border-radius: var(--border-radius-sm, 4px);
     margin-left: var(--spacing-sm, 8px);
     min-width: 48px;
     min-height: 48px;
     -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
     touch-action: manipulation;
     transition: background 0.2s ease, transform 0.1s ease;
   }

   .mobile-menu-btn:hover {
     background: var(--color-primary-dark, #0f766e);
   }

   .mobile-menu-btn:focus-visible {
     outline: 2px solid var(--text-inverse, #ffffff);
     outline-offset: 2px;
   }

   .mobile-menu-btn:active {
     transform: scale(0.98);
   }

   .menu-label {
     white-space: nowrap;
   }

   .menu-icon {
     font-size: 0.75rem;
     transition: transform 0.3s ease;
   }

   :host([sidebar-collapsed]) .menu-icon {
     transform: rotate(180deg);
   }

   @media (max-width: 768px) {
     .mobile-menu-btn {
       display: flex;
     }
   }
   ```

3. Add dark theme styles for mobile menu button:
   ```css
   /* Dark theme */
   :host-context([data-theme="dark"]) .mobile-menu-btn {
     background: var(--color-primary, #0d9488);
   }

   :host-context([data-theme="dark"]) .mobile-menu-btn:hover {
     background: var(--color-primary-light, #14b8a6);
   }
   ```

4. Update the attributeChangedCallback to rotate the menu icon (optional, CSS handles it):
   The CSS `:host([sidebar-collapsed]) .menu-icon` selector will handle the icon rotation automatically.

5. Ensure ARIA attributes are correct:
   - aria-label on button: "Toggle parameters sidebar"
   - aria-expanded should be updated dynamically based on sidebar-collapsed state (optional enhancement)
  </action>
  <verify>
Run `npm run build` to verify TypeScript compiles. Open dev server at mobile viewport (768px or below) - should see "eVelo Parameters" button with teal background in header. Tap button - sidebar should expand/collapse, and the icon should flip.
  </verify>
  <done>
Mobile menu button displays "eVelo Parameters" text with teal background. Icon rotates to indicate expand/collapse state. Touch target is 48x48px minimum for accessibility. Dark theme styling works correctly.
  </done>
</task>

</tasks>

<verification>
1. **Desktop branded label**: Sidebar toggle shows "eVelo Parameters" with teal (#0d9488) background and white text.
2. **Desktop rotation**: When sidebar collapsed, label rotates 90 degrees using writing-mode: vertical-rl.
3. **Mobile branded button**: Mobile menu button shows "eVelo Parameters" text with down-arrow icon, teal background.
4. **Mobile icon rotation**: Arrow icon rotates 180 degrees when sidebar is collapsed.
5. **Accessibility**: Correct ARIA labels and aria-expanded states; keyboard navigation works.
6. **Dark theme**: Teal color scheme maintained in dark theme with appropriate hover states.
7. **Touch targets**: Mobile button is at least 48x48px for reliable touch interaction.
8. **Integration with Plan 01**: All vertical collapse and auto-collapse behavior from 22-01 still works.
</verification>

<success_criteria>
- "eVelo Parameters" text label visible on both desktop toggle and mobile menu button
- Desktop collapsed state shows rotated label (writing-mode: vertical-rl)
- Teal (#0d9488) background with white text for brand consistency
- ARIA attributes correct for screen reader accessibility
- Dark theme styling maintained
- All behavior from 22-01 (vertical collapse, auto-collapse) continues to work
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/22-mobile-sidebar-ux-redesign/22-02-SUMMARY.md`
</output>
