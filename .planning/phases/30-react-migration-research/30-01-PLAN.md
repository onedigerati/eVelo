---
phase: 30-react-migration-research
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/phases/30-react-migration-research/30-COMPONENT-INVENTORY.md
  - .planning/phases/30-react-migration-research/30-STATE-PATTERNS.md
autonomous: true

must_haves:
  truths:
    - "All 51 Web Components are cataloged with complexity ratings"
    - "Current state management patterns are documented (events, services, IndexedDB)"
    - "Component dependencies and relationships are mapped"
  artifacts:
    - path: ".planning/phases/30-react-migration-research/30-COMPONENT-INVENTORY.md"
      provides: "Complete component catalog with complexity ratings"
      min_lines: 200
    - path: ".planning/phases/30-react-migration-research/30-STATE-PATTERNS.md"
      provides: "State management pattern documentation"
      min_lines: 100
  key_links:
    - from: "30-COMPONENT-INVENTORY.md"
      to: "30-RESEARCH.md"
      via: "Migration complexity estimates"
      pattern: "complexity"
---

<objective>
Create comprehensive component inventory and state management documentation for the React migration research.

Purpose: Fulfills success criteria #1 (component inventory) and #2 (state management patterns) from the phase requirements. These documents provide the foundation for migration effort estimation and strategy.

Output: Two documentation files - component inventory catalog and state management pattern analysis.
</objective>

<execution_context>
@C:\Users\ungac\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\ungac\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-react-migration-research/30-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Component Inventory Document</name>
  <files>.planning/phases/30-react-migration-research/30-COMPONENT-INVENTORY.md</files>
  <action>
    Create a comprehensive component inventory document by:

    1. **Scan all Web Components** in the codebase:
       - src/components/ui/*.ts (39 UI components)
       - src/charts/*.ts (11 chart components)
       - src/components/app-root.ts (1 root component)

    2. **For each component, document:**
       - Component name (custom element tag)
       - File path and LOC
       - Category: atom (simple), molecule (composite), organism (complex), layout
       - Complexity rating (1-5 scale based on: LOC, child components, state, events)
       - Dependencies (other components it imports/uses)
       - Props/attributes it accepts
       - Events it dispatches
       - Migration difficulty estimate (easy/medium/hard)

    3. **Create complexity matrix:**
       - 1 (Simple): <100 LOC, no children, minimal state
       - 2 (Basic): 100-200 LOC, few children, simple state
       - 3 (Moderate): 200-400 LOC, multiple children, event-driven state
       - 4 (Complex): 400-800 LOC, many children, complex state management
       - 5 (Very Complex): >800 LOC, extensive integration, orchestration role

    4. **Document relationships:**
       - Parent-child component hierarchy
       - Event flow diagrams (text-based)
       - Shared dependencies

    5. **Summary statistics:**
       - Total components by category
       - Distribution by complexity
       - Estimated migration effort by complexity tier

    Format as markdown with tables for the inventory and ASCII diagrams for relationships.
  </action>
  <verify>
    - grep -c "component" 30-COMPONENT-INVENTORY.md returns >50 (all components listed)
    - File contains complexity ratings for each component
    - File contains migration difficulty estimates
    - File has summary statistics section
  </verify>
  <done>
    30-COMPONENT-INVENTORY.md exists with:
    - All 51 Web Components cataloged
    - Complexity ratings (1-5) for each
    - Migration difficulty estimates (easy/medium/hard)
    - Component relationship mapping
    - Summary statistics
  </done>
</task>

<task type="auto">
  <name>Task 2: Document State Management Patterns</name>
  <files>.planning/phases/30-react-migration-research/30-STATE-PATTERNS.md</files>
  <action>
    Analyze and document current state management patterns by:

    1. **Identify all state management mechanisms:**
       - CustomEvents (list all event types, who dispatches, who listens)
       - Service singletons (theme-service, comparison-state, etc.)
       - IndexedDB via Dexie.js (portfolios, settings, market data)
       - Component internal state (properties, attributes)
       - SessionStorage (comparison mode state)

    2. **Map event flow:**
       - Search codebase for `dispatchEvent`, `addEventListener`, `CustomEvent`
       - Document event names, payloads, and communication patterns
       - Identify event bubbling paths (composed: true)

    3. **Document service patterns:**
       - theme-service.ts (global theme state)
       - comparison-state.ts (comparison mode state)
       - Any other singleton services

    4. **Document IndexedDB schema:**
       - Tables (portfolios, marketData, settings)
       - How components interact with db.ts
       - Query patterns (useLiveQuery equivalent in current code)

    5. **React migration mapping:**
       - For each current pattern, document the React equivalent:
         - CustomEvents -> props/callbacks or Zustand actions
         - Service singletons -> Zustand stores or React Context
         - IndexedDB -> dexie-react-hooks (useLiveQuery)
         - Component state -> useState/useReducer

    6. **Identify migration challenges:**
       - Events that cross many components (need global state)
       - Circular event dependencies
       - Timing-sensitive event sequences

    Format as markdown with code snippets showing current vs React patterns.
  </action>
  <verify>
    - File lists all CustomEvent types used in codebase
    - File documents theme-service and comparison-state patterns
    - File maps current patterns to React equivalents
    - File identifies migration challenges
  </verify>
  <done>
    30-STATE-PATTERNS.md exists with:
    - Complete CustomEvent inventory
    - Service singleton documentation
    - IndexedDB access patterns
    - React migration mapping for each pattern
    - Migration challenges identified
  </done>
</task>

</tasks>

<verification>
- Both documents exist in .planning/phases/30-react-migration-research/
- Component inventory has all 51 components with complexity ratings
- State patterns document covers events, services, and IndexedDB
- Documents cross-reference each other where relevant
</verification>

<success_criteria>
- Success criteria #1 met: Component inventory completed with complexity ratings
- Success criteria #2 met: State management patterns documented
- All 51 Web Components cataloged with migration difficulty estimates
- Event flow and service patterns mapped to React equivalents
</success_criteria>

<output>
After completion, create `.planning/phases/30-react-migration-research/30-01-SUMMARY.md`
</output>
