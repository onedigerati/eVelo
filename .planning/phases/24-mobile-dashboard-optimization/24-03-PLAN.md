---
phase: 24-mobile-dashboard-optimization
plan: 03
type: execute
wave: 2
depends_on: ["24-01", "24-02"]
files_modified:
  - src/components/ui/strategy-analysis.ts
  - src/components/ui/salary-equivalent-section.ts
  - src/components/ui/recommendations-section.ts
  - src/charts/correlation-heatmap.ts
autonomous: false

must_haves:
  truths:
    - "All dashboard components use responsive stacked layout on mobile"
    - "Correlation heatmap is scrollable and not clipped on mobile"
    - "Strategy analysis cards stack vertically on mobile"
  artifacts:
    - path: "src/components/ui/strategy-analysis.ts"
      provides: "Mobile-optimized strategy comparison"
      contains: "max-width: 100%"
    - path: "src/charts/correlation-heatmap.ts"
      provides: "Scrollable correlation matrix"
      contains: "overflow-x: auto"
  key_links:
    - from: "strategy-analysis.ts"
      to: "comparison cards"
      via: "CSS grid to flex-column"
      pattern: "flex-direction.*column"
---

<objective>
Fix remaining mobile layout issues in strategy-analysis, salary-equivalent, recommendations, and correlation heatmap components. These components need proper mobile constraints and visual verification.

Purpose: Complete the mobile optimization by fixing all remaining clipped content and verifying responsive layouts across all dashboard components.
Output: All dashboard components display correctly at 375px viewport width without clipping.
</objective>

<execution_context>
@C:\Users\ungac\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\ungac\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/24-mobile-dashboard-optimization/24-RESEARCH.md
@.planning/phases/24-mobile-dashboard-optimization/24-01-SUMMARY.md
@.planning/phases/24-mobile-dashboard-optimization/24-02-SUMMARY.md
@src/components/ui/strategy-analysis.ts
@src/charts/correlation-heatmap.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix strategy-analysis and salary-equivalent mobile layout</name>
  <files>src/components/ui/strategy-analysis.ts, src/components/ui/salary-equivalent-section.ts</files>
  <action>
Update both components to ensure proper mobile layout:

**strategy-analysis.ts:**

1. Add to :host:
   ```css
   :host {
     display: block;
     max-width: 100%;
   }
   ```

2. Update @media (max-width: 768px) section to include:
   ```css
   .strategy-analysis {
     max-width: 100%;
     overflow-x: hidden;
   }

   .verdict-banner {
     max-width: 100%;
     overflow-x: hidden;
   }

   /* Ensure comparison cards stack and don't overflow */
   .comparison-cards {
     flex-direction: column;
     max-width: 100%;
   }

   .strategy-card {
     max-width: 100%;
     width: 100%;
   }

   /* Break long text in metrics */
   .metric-value {
     word-break: break-word;
   }

   .wealth-grid {
     grid-template-columns: 1fr;
     max-width: 100%;
   }

   .wealth-card {
     max-width: 100%;
   }
   ```

3. If there's a .comparison-summary or similar, ensure it also has max-width:100%

**salary-equivalent-section.ts:**

1. Add to :host:
   ```css
   :host {
     display: block;
     max-width: 100%;
   }
   ```

2. In @media (max-width: 768px):
   ```css
   .salary-banner {
     max-width: 100%;
     overflow-x: hidden;
   }

   .salary-value {
     word-break: break-word;
   }

   .salary-context {
     max-width: 100%;
   }
   ```
  </action>
  <verify>
Build succeeds: `npm run build`
Mobile DevTools at 375px:
- Strategy Analysis section fully visible
- Comparison cards stacked vertically
- Salary Equivalent banner fits viewport
  </verify>
  <done>
strategy-analysis.ts and salary-equivalent-section.ts have max-width:100% constraints and proper column stacking
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix correlation heatmap and recommendations mobile layout</name>
  <files>src/charts/correlation-heatmap.ts, src/components/ui/recommendations-section.ts</files>
  <action>
**correlation-heatmap.ts:**

The correlation heatmap uses an HTML table which may overflow. Ensure it's properly scrollable:

1. Add or update :host:
   ```css
   :host {
     display: block;
     max-width: 100%;
   }
   ```

2. Ensure the container has scroll wrapper. In styles(), add:
   ```css
   .heatmap-container {
     max-width: 100%;
     overflow-x: auto;
     -webkit-overflow-scrolling: touch;
   }

   .heatmap-table {
     min-width: 400px;  /* Force scroll on narrow viewports */
   }
   ```

3. In @media (max-width: 768px):
   ```css
   .heatmap-container {
     margin: 0 calc(-1 * var(--spacing-sm, 8px));
     padding: 0 var(--spacing-sm, 8px);
   }

   .heatmap-table {
     font-size: var(--font-size-xs, 0.75rem);
   }

   .heatmap-table th,
   .heatmap-table td {
     padding: 4px;
     min-width: 50px;
   }
   ```

4. Add scroll indicator pattern if correlation matrix is large (optional but recommended):
   - Wrap in scroll-container similar to tables in Plan 02

**recommendations-section.ts:**

1. Add to :host:
   ```css
   :host {
     display: block;
     max-width: 100%;
   }
   ```

2. In @media (max-width: 768px):
   ```css
   .recommendations-wrapper {
     max-width: 100%;
     overflow-x: hidden;
   }

   .insights-grid {
     grid-template-columns: 1fr;
     max-width: 100%;
   }

   .insight-card {
     max-width: 100%;
   }

   .considerations-grid {
     grid-template-columns: 1fr;
   }

   .consideration-item {
     max-width: 100%;
   }
   ```
  </action>
  <verify>
Build succeeds: `npm run build`
Mobile DevTools at 375px:
- Correlation heatmap scrolls horizontally when needed
- Recommendations section cards stack vertically
- No horizontal page overflow from these components
  </verify>
  <done>
correlation-heatmap.ts has scrollable container; recommendations-section.ts stacks items vertically on mobile
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete mobile dashboard optimization across all components:
- results-dashboard.ts: All sections constrained to viewport
- key-metrics-banner.ts: Cards don't clip
- param-summary.ts: Content fits viewport
- percentile-spectrum.ts: Bar fits viewport
- yearly-analysis-table.ts: Scroll indicators visible
- sell-yearly-analysis-table.ts: Scroll indicators visible
- performance-table.ts: Scroll indicators visible
- return-probability-table.ts: Scroll indicators visible
- strategy-analysis.ts: Cards stack vertically
- salary-equivalent-section.ts: Banner fits viewport
- recommendations-section.ts: Cards stack vertically
- correlation-heatmap.ts: Scrollable matrix
  </what-built>
  <how-to-verify>
1. Start dev server: `npm run dev`
2. Open browser DevTools and set viewport to 375x667 (iPhone SE)
3. Run a simulation with default parameters
4. Scroll through entire dashboard and verify:
   - [ ] No horizontal scrollbar on the page body
   - [ ] Portfolio Projection chart fully visible (no clipping)
   - [ ] Terminal Value Distribution chart fully visible
   - [ ] Key metrics cards (Strategy Success, Portfolio Growth, Leverage Safety) all visible
   - [ ] Tables show gradient scroll indicators on right edge
   - [ ] Swiping tables scrolls them horizontally
   - [ ] Strategy Analysis comparison cards stacked vertically
   - [ ] Correlation heatmap scrollable (swipe horizontally)
   - [ ] Recommendations section cards stacked
5. Test at 768px width (tablet) - single column layout active
6. Test at 1024px width (desktop) - two column layout active

Note any remaining clipped content or overflow issues.
  </how-to-verify>
  <resume-signal>Type "approved" if all mobile layouts look correct, or describe specific issues that still need fixing</resume-signal>
</task>

</tasks>

<verification>
1. Build passes: `npm run build`
2. Visual verification at 375px viewport:
   - All charts fit without clipping
   - All cards fit without clipping
   - All tables have scroll indicators
   - All grids stack to single column
3. Touch behavior verification:
   - Tables scroll with finger swipe
   - Correlation heatmap scrolls with finger swipe
   - Page doesn't have unwanted horizontal scroll
4. No horizontal page overflow at any dashboard scroll position
</verification>

<success_criteria>
- All 12+ dashboard components have proper mobile constraints
- No horizontal page scrollbar at 375px viewport
- All tables have visible scroll indicators
- All multi-column grids stack to single column on mobile
- Touch scrolling works on all scrollable elements
- Human verification confirms mobile UX is acceptable
</success_criteria>

<output>
After completion, create `.planning/phases/24-mobile-dashboard-optimization/24-03-SUMMARY.md`
</output>
