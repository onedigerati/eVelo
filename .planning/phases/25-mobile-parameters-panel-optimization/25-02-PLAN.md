---
phase: 25-mobile-parameters-panel-optimization
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/app-root.ts
  - src/components/ui/main-layout.ts
autonomous: true

must_haves:
  truths:
    - "Run Simulation button has minimum 48px touch target height"
    - "Button has touch-action: manipulation to prevent double-tap zoom"
    - "Layout uses dvh units for dynamic viewport height on mobile"
    - "Dark theme styling applies correctly to sticky button area"
  artifacts:
    - path: "src/components/app-root.ts"
      provides: "Touch-optimized button styles"
      contains: "touch-action: manipulation"
    - path: "src/components/ui/main-layout.ts"
      provides: "Dynamic viewport height units"
      contains: "100dvh"
  key_links:
    - from: "app-root.ts .btn-primary"
      to: "touch optimization"
      via: "touch-action and min-height"
      pattern: "min-height:\\s*48px"
    - from: "main-layout.ts :host"
      to: "dynamic viewport"
      via: "dvh units with vh fallback"
      pattern: "100dvh"
---

<objective>
Optimize touch interactions for the Run Simulation button and implement dynamic viewport height (dvh) to handle Android Chrome address bar behavior.

Purpose: Mobile users need reliable touch targets and the layout must handle dynamic viewport changes when Android Chrome's address bar shows/hides.
Output: Touch-optimized button styles in app-root.ts and dvh viewport units in main-layout.ts.
</objective>

<execution_context>
@C:\Users\ungac\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\ungac\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/25-mobile-parameters-panel-optimization/25-RESEARCH.md

Key findings from research:
- Material Design recommends 48x48dp minimum touch targets
- touch-action: manipulation disables double-tap zoom for faster response
- dvh (dynamic viewport height) accounts for mobile browser chrome
- -webkit-tap-highlight-color provides visual tap feedback
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add touch optimization to Run Simulation button</name>
  <files>src/components/app-root.ts</files>
  <action>
Update the .btn-primary styles in app-root.ts to be fully touch-optimized:

1. Add `min-height: 48px` to ensure adequate touch target (Material Design guideline)
2. Add `touch-action: manipulation` to disable double-tap zoom and reduce tap delay
3. Add `-webkit-tap-highlight-color: rgba(13, 148, 136, 0.2)` for teal-tinted tap feedback
4. Ensure the button uses `width: 100%` to fill the footer width

The existing styles already have padding and flex layout. Just add the touch-specific properties.

Also add a mobile-specific media query for extra touch comfort:

```css
@media (max-width: 768px) {
  .btn-primary {
    min-height: 52px;  /* Slightly larger on mobile */
    font-size: var(--font-size-base, 1rem);
  }
}
```

DO NOT remove existing styles - only add the touch optimization properties.
  </action>
  <verify>npm run build should succeed without errors</verify>
  <done>app-root.ts .btn-primary has min-height: 48px, touch-action: manipulation, and -webkit-tap-highlight-color</done>
</task>

<task type="auto">
  <name>Task 2: Implement dynamic viewport height units</name>
  <files>src/components/ui/main-layout.ts</files>
  <action>
Update main-layout.ts to use dynamic viewport height (dvh) with fallback:

1. In :host styles, update height to use dvh with fallback:
   ```css
   :host {
     display: block;
     height: 100vh;      /* Fallback for older browsers */
     height: 100dvh;     /* Dynamic viewport height (Chrome 108+, Safari 15.4+) */
   }
   ```

2. In the mobile media query (@media max-width: 768px), update .layout:
   ```css
   .layout {
     height: 100vh;
     height: 100dvh;
   }
   ```

The dvh unit automatically adjusts when Android Chrome's address bar shows/hides,
preventing the layout from jumping or having incorrect height.

Also add overscroll-behavior to prevent pull-to-refresh interference:

3. Add to .sidebar-area in mobile media query:
   ```css
   .sidebar-area {
     overscroll-behavior-y: contain;  /* Prevent pull-to-refresh when scrolling */
   }
   ```

DO NOT remove existing grid-template-areas or other layout properties.
  </action>
  <verify>npm run build should succeed without errors</verify>
  <done>main-layout.ts uses dvh units with vh fallback and has overscroll-behavior for mobile</done>
</task>

<task type="auto">
  <name>Task 3: Verify dark theme styling for sticky footer</name>
  <files>src/components/ui/sidebar-panel.ts</files>
  <action>
Verify and enhance dark theme styling for the sticky footer in sidebar-panel.ts:

1. Check that :host-context([data-theme="dark"]) selector exists
2. Add dark theme styling for .sidebar-footer if not present:
   ```css
   :host-context([data-theme="dark"]) .sidebar-footer {
     background: var(--surface-secondary, #1e293b);
     border-top-color: var(--border-color, #334155);
     box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.3);  /* Darker shadow for dark theme */
   }
   ```

3. The box-shadow should be slightly stronger in dark mode to provide visual separation.

This ensures the sticky button footer maintains proper contrast and visual separation in dark theme.
  </action>
  <verify>npm run build should succeed without errors</verify>
  <done>sidebar-panel.ts has dark theme styling for .sidebar-footer with appropriate background and shadow</done>
</task>

</tasks>

<verification>
1. Build verification: `npm run build` completes without TypeScript errors
2. CSS verification: app-root.ts contains `touch-action: manipulation` in .btn-primary
3. CSS verification: app-root.ts contains `min-height: 48px` in .btn-primary
4. CSS verification: main-layout.ts contains `100dvh` in :host styles
5. CSS verification: main-layout.ts contains `overscroll-behavior` in mobile styles
6. CSS verification: sidebar-panel.ts contains dark theme styling for .sidebar-footer
</verification>

<success_criteria>
- [ ] app-root.ts .btn-primary has min-height: 48px
- [ ] app-root.ts .btn-primary has touch-action: manipulation
- [ ] app-root.ts .btn-primary has -webkit-tap-highlight-color
- [ ] main-layout.ts uses dvh units with vh fallback
- [ ] main-layout.ts has overscroll-behavior-y: contain for mobile sidebar
- [ ] sidebar-panel.ts has dark theme styling for .sidebar-footer
- [ ] Build succeeds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/25-mobile-parameters-panel-optimization/25-02-SUMMARY.md`
</output>
