---
phase: 25-mobile-parameters-panel-optimization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/sidebar-panel.ts
  - src/components/ui/main-layout.ts
autonomous: true

must_haves:
  truths:
    - "Run Simulation button is visible without scrolling on mobile when sidebar is expanded"
    - "Parameter sections scroll independently while button remains fixed at bottom"
    - "Last parameter input is fully visible and not obscured by sticky button"
    - "Button has visual separation from scrolling content"
  artifacts:
    - path: "src/components/ui/sidebar-panel.ts"
      provides: "Sticky footer with proper padding and safe area insets"
      contains: "position: sticky"
    - path: "src/components/ui/main-layout.ts"
      provides: "Mobile sidebar height constraints for sticky positioning"
      contains: "min-height: 0"
  key_links:
    - from: "sidebar-panel.ts .sidebar-footer"
      to: "sticky positioning"
      via: "CSS position: sticky with bottom: 0"
      pattern: "position:\\s*sticky"
    - from: "sidebar-panel.ts .sidebar-content"
      to: "padding-bottom"
      via: "padding equal to footer height + spacing"
      pattern: "padding-bottom:\\s*calc"
---

<objective>
Add sticky positioning to the Run Simulation button footer in sidebar-panel so it remains visible at all times on mobile, with proper padding to prevent content overlap.

Purpose: Users on mobile need constant access to the Run Simulation button while scrolling through parameter sections. Currently the button is at the bottom and requires scrolling to reach.
Output: sidebar-panel.ts and main-layout.ts with sticky footer positioning and proper mobile layout constraints.
</objective>

<execution_context>
@C:\Users\ungac\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\ungac\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/25-mobile-parameters-panel-optimization/25-RESEARCH.md

Key architecture from research:
- sidebar-panel.ts uses Grid layout: auto/1fr/auto for toggle/content/footer
- Button is slotted via `<div slot="footer">` from app-root.ts
- main-layout.ts controls mobile sidebar visibility via sidebar-collapsed attribute
- Phase 24 already added min-height: 0 to sidebar-area for height constraint propagation
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add sticky footer positioning to sidebar-panel.ts</name>
  <files>src/components/ui/sidebar-panel.ts</files>
  <action>
Update the .sidebar-footer styles in sidebar-panel.ts to use position: sticky:

1. Add `position: sticky` and `bottom: 0` to .sidebar-footer
2. Add `z-index: 10` to ensure footer appears above scrolling content
3. Add `box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1)` for visual separation
4. Keep existing border-top and background styles

Update .sidebar-content padding to prevent content hiding:

1. Add `padding-bottom: calc(68px + 24px)` to .sidebar-content (footer height + spacing)
2. Add `-webkit-overflow-scrolling: touch` for iOS momentum scrolling

Add mobile-specific overrides at @media (max-width: 768px):

1. `.sidebar-content` - increase padding-bottom to include safe-area-inset:
   `padding-bottom: calc(68px + 32px + env(safe-area-inset-bottom, 0px))`
2. `.sidebar-footer` - add safe-area-inset padding:
   `padding-bottom: max(16px, env(safe-area-inset-bottom, 0px))`

The values:
- 68px = button height (48px min-height + 16px vertical padding)
- 24px = normal spacing buffer
- 32px = mobile spacing buffer (larger for thumb clearance)
- env(safe-area-inset-bottom) = iOS home bar, Android gesture bar

DO NOT change the Grid layout structure (auto/1fr/auto) as it correctly constrains the sidebar.
  </action>
  <verify>npm run build should succeed without errors</verify>
  <done>sidebar-panel.ts has sticky footer with position: sticky, bottom: 0, box-shadow, and proper padding-bottom on .sidebar-content including mobile-specific safe-area-insets</done>
</task>

<task type="auto">
  <name>Task 2: Ensure mobile layout supports sticky positioning</name>
  <files>src/components/ui/main-layout.ts</files>
  <action>
Verify and update main-layout.ts mobile styles to ensure sticky positioning works correctly:

1. In the @media (max-width: 768px) section for .sidebar-area:
   - Confirm `min-height: 0` is present (should be from Phase 24)
   - Add `display: flex` and `flex-direction: column` if not present
   - This ensures the sidebar-panel fills the area and sticky positioning works

2. Add a new rule for when sidebar is NOT collapsed (expanded state) on mobile:
   - When sidebar is expanded, it should take up available space
   - The grid-template-rows already has `1fr` for sidebar area

3. Update the `.sidebar-area ::slotted(*)` rule in mobile:
   - Ensure `height: 100%` is set
   - Add `min-height: 0` to allow shrinking

The key insight: sticky positioning requires a parent with constrained height.
The Grid layout with 1fr already provides this constraint when combined with min-height: 0.
  </action>
  <verify>npm run build should succeed without errors</verify>
  <done>main-layout.ts mobile styles ensure proper height constraints for sticky positioning in sidebar-area</done>
</task>

</tasks>

<verification>
1. Build verification: `npm run build` completes without TypeScript errors
2. CSS verification: sidebar-panel.ts contains `position: sticky` and `bottom: 0` in .sidebar-footer
3. CSS verification: sidebar-panel.ts contains `padding-bottom: calc(` in .sidebar-content
4. CSS verification: sidebar-panel.ts contains `env(safe-area-inset-bottom` in mobile media query
5. CSS verification: main-layout.ts contains `min-height: 0` in .sidebar-area mobile styles
</verification>

<success_criteria>
- [ ] sidebar-panel.ts .sidebar-footer has position: sticky, bottom: 0, z-index, and box-shadow
- [ ] sidebar-panel.ts .sidebar-content has padding-bottom calculated from footer height
- [ ] sidebar-panel.ts has mobile-specific styles with safe-area-inset-bottom
- [ ] main-layout.ts mobile .sidebar-area has min-height: 0 for height constraint
- [ ] Build succeeds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/25-mobile-parameters-panel-optimization/25-01-SUMMARY.md`
</output>
